{% import "front/_forms.html" as forms %}

<form action="{{ action_url }}" method="post" class="resform">
    <input type="hidden" name="step" value="2">

    <fieldset>
        <h2>Dane osobowe</h2>
        <fieldset class="one-line{% if errors.sex %} error{% endif %}">
            {% if errors.sex %}
            <span class="error_desc">{{ errors.sex.0 }}</span>
            {% endif %}
            <label class="main">Płeć:</label>
            <label>
                <span>Kobieta:</span>
                <input type="radio" name="sex" value="female"{% if values.sex == 'female' %} checked{% endif %}>
            </label>
            <label>
                <span>Mężczyzna:</span>
                <input type="radio" name="sex" value="male"{% if values.sex == 'male' %} checked{% endif %}>
            </label>
        </fieldset>

        {{ forms.label_input('Imię:', 'text', 'first_name', values.first_name, errors.first_name) }}

        {{ forms.label_input('Nazwisko:', 'text', 'last_name', values.last_name, errors.last_name) }}

        {{ forms.label_input('Data urodzenia:', 'text', 'birth_date', values.birth_date, errors.birth_date, 'dd-mm-rrrr') }}

        {{ forms.label_input('Adres e-mail:', 'text', 'email', values.email, errors.email, 'twoj@adres.com') }}

        {{ forms.label_input('Numer telefonu:', 'text', 'phone', values.phone, errors.phone) }}

        {{ forms.label_input('Miasto:', 'text', 'city', values.city, errors.city) }}

    <fieldset>
    <h2>Informacje dodatkowe</h2>
    <fieldset>
        <h3>Osoba niepełnosprawna/opiekun osoby niepełnosprawnej</h3>
        <p>W przypadku osób niepełnosprawnych oraz ich opiekunów, proszę podać imię i nazwisko opiekuna / osoby niepełnosprawnej, którą się opiekujesz - ułatwi to nam przydzielenie do wspólnego pokoju.</p>
        <label class="main two-line">Jestem:</label>
        <label class="one-line">
            <span>osobą niepełnosprawną:</span>
            <input type="hidden" name="disabled" value="0" />
            <input type="checkbox" name="disabled" value="1"
                data-set-id="disabled_set"
                {% if values.disabled == '1' %} checked{% endif %}>
        </label>
        <label>
            <span>opiekunem osoby niepełnosprawnej:</span>
            <input type="hidden" name="disabled_guardian" value="0" />
            <input type="checkbox" name="disabled_guardian" value="1"
                data-set-id="disabled_guardian_set"
                {% if values.disabled_guardian == '1' %} checked{% endif %}>
        </label>

        <fieldset id="disabled_set" class="optional" disabled>
            <label>
                <span>Stopień/rodzaj niepełnosprawności:</span>
                <input type="text" name="disability_type" value="{{ values.disability_type }}">
            </label>

            <label>Czy możesz chodzić po schodach?</label>
            <label>
                <span>tak</span>
                <input type="radio" name="stairs_accessibility" value="1"
                    {% if values.stairs_accessibility == '1' %} checked{% endif %}>
            </label>

            <label>
                <span>nie</span>
                <input type="radio" name="stairs_accessibility" value="0"
                    {% if values.stairs_accessibility == '0' %} checked{% endif %}>
            </label>

            <label>
                <span>Imię i nazwisko opiekuna:</span>
                <input type="text" name="guardian_person_name" value="{{ values.guardian_person_name }}">
            </label>
        </fieldset>

        <fieldset id="disabled_guardian_set" class="optional" disabled>
            <label>
                <span>Imię i nazwisko osoby niepełnosprawnej, którą się opiekuję:</span>
                <input type="text" name="disabled_person_name">
            </label>
        </fieldset>
    </fieldset>

    <fieldset>
        <h3>Niepełnoletni uczestnicy i ich opiekunowie</h3>
        <p></p>
        <label>
            <span class="main">Jestem osobą niepełnoletnią, będę na wyjeździe bez opieki rodziców/prawnych opiekunów:</span>
            <input type="checkbox" name="underaged" value="alone">
            <span class="description">W rekolekcjach mogą wziąć udział osoby niepełnoletnie bez opieki i obecności rodziców/prawnych opiekunów. Muszą jednak mieć co najmniej 16 lat i przesłać do Organizatora zgodę rodziców/prawnych opiekunów na udział ich dziecka/podopiecznego w rekolekcjach - pismo do uzupełnienia i podpisania zostanie wysłane w mailu potwierdzającym zapis. Zgodę należy przesłać jako skan na adres zapisyrekolekcje@gmail.com w ciągu 3 dni od zapisu, oryginał natomiast uczestnik rekolekcji przekaże Organizatorowi przy zakwaterowaniu.</span>
        </label>

        <label>
            <span class="main">Jestem osobą niepełnoletnią, wezmę udział w rekolekcjach z opiekunem, który nie jest moim rodzicem/opiekunem prawnym</span>
            <input type="checkbox" name="underaged_guardian" value="with_guardian">
            <span class="description">Jeżeli nieletni uczestnik bierze udział w rekolekcjach pod opieką osoby niebędącej jego rodzicem/opiekunem prawnym, zobowiązany jest przesłać do Organizatora zgodę rodziców/prawnych opiekunów na udział ich dziecka/podopiecznego w rekolekcjach oraz wskazanie opiekuna - pismo do uzupełnienia i podpisania zostanie wysłane w mailu potwierdzającym zapis. Zgodę należy przesłać jako skan na adres: zapisyrekolekcje@gmail.com w ciągu 3 dni od zapisu, oryginał natomiast uczestnik rekolekcji przekaże Organizatorowi przy zakwaterowaniu. Jeśli dotyczy to Państwa, prosimy również o zaznaczenie odpowiedniego pola poniżej.</span>
        </label>

        <fieldset>
            <label>
                <span class="main">Jestem opiekunem osoby niepełnoletniej</span>
                <span>Wpisz imię i nazwisko osoby, za którą bierzesz odpowiedzialność:</span>
                <input type="text" name="underaged_person_name" value="{{ values.underaged_person_name }}">
            </label>
        </fieldset>

    </fieldset>

    <fieldset id="family_fieldset">
        <h3>Członkowie rodziny</h3>
        <button id="family_button">Dodaj członka rodziny/dziecko</button>

        <div style="display: none;" id="family_template">
            <fieldset disabled>
                <label data-name="first_name">
                    <span>Imię:</span>
                    <input type="text" name="family_first_name[]" value="">
                </label>
                <label data-name="last_name">
                    <span>Nazwisko:</span>
                    <input type="text" name="family_last_name[]" value="">
                </label>
                <label data-name="birth_date">
                    <span>Data urodzenia:</span>
                    <input type="text" name="family_birth_date[]" value="">
                </label>
                <label class="family_remove">Usuń</label>
            </fieldset>
        </div>
        <script id="family_data">
            window.resform_family_data = {
                first_names: {{ values.family_first_name|json_encode()|raw }},
                last_names: {{ values.family_last_name|json_encode()|raw }},
                birth_dates: {{ values.family_birth_date|json_encode()|raw }},
                first_names_errors: [
                    {% for i, b in values.family_first_name %}
                    '{{ errors['family_first_name[' ~ i ~ ']'].0 }}',
                    {% endfor %}
                ],
                last_name_errors: [
                    {% for i, b in values.family_last_name %}
                    '{{ errors['family_last_name[' ~ i ~ ']'].0 }}',
                    {% endfor %}
                ],
                birth_date_errors: [
                    {% for i, b in values.family_birth_date %}
                    '{{ errors['family_birth_date[' ~ i ~ ']'].0 }}',
                    {% endfor %}
                ]
            };
        </script>
    </fieldset>

    <fieldset class="submit">
        <button>Idź dalej</button>
        <button name="step" value="0">Wróc do poprzedniego kroku</button>
    </fieldset>
</form>
